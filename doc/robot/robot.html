<!DOCTYPE html><html lang="en"><head><title>robot/robot</title></head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0"><meta name="groc-relative-root" content="../"><meta name="groc-document-path" content="robot/robot"><meta name="groc-project-path" content="assets/robot/robot.js"><link rel="stylesheet" type="text/css" media="all" href="../assets/style.css"><script type="text/javascript" src="../assets/behavior.js"></script><body><div id="meta"><div class="file-path">assets/robot/robot.js</div></div><div id="document"><div class="segment"><div class="comments "><div class="wrapper"><h1 id="robotjs">robot.js</h1>
<p>This file contains code all about the robot.</p></div></div><div class="code"><div class="wrapper"><span class="hljs-keyword">var</span> robotEl = <span class="hljs-built_in">document</span>.getElementById(<span class="hljs-string">'robot'</span>);
<span class="hljs-keyword">var</span> cecil = <span class="hljs-keyword">new</span> Robot(robotEl);

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Robot</span>(<span class="hljs-params">robotEl</span>) </span>{</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p><code>robotMethods</code> will hold onto what the robot can do.</p></div></div><div class="code"><div class="wrapper">  <span class="hljs-keyword">var</span> robotMethods = {
    getPosition: getPosition,
    getSize: getSize,
    moveTo: moveTo,
    move: move,
    change: change,
    reset: reset,
    name: name,
    flip: flip,
    getElement: getElement
  };</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>We are going to use <code>robot</code> to hold onto some private information about our robot.</p></div></div><div class="code"><div class="wrapper">  <span class="hljs-keyword">var</span> robot = {};</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p><code>setBody</code> gives the robot a body that is the HTML element passed in as <code>robotEl</code></p></div></div><div class="code"><div class="wrapper">  setBody(robotEl);</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>Give <code>robotMethods</code> out to the coder use elsewhere, as in the <code>console</code>.</p></div></div><div class="code"><div class="wrapper">  <span class="hljs-keyword">return</span> robotMethods;</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><h1 id="functions">Functions</h1></div></div></div><div class="segment"><div class="comments doc-section"><div class="wrapper"><h2 id="give-the-robot-a-body">Give the robot a body.</h2>
<p>Parameters:</p>
<ul>
<li><strong>robotElement must be a DOMElement.</strong><br/>(The HTML Element that the robot&#39;s capabilities should be attached to.)</li>
</ul></div></div><div class="code"><div class="wrapper">  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">setBody</span>(<span class="hljs-params">robotElement</span>)</span>{
    robot.element = robotElement;
    robot.img = robot.element.getElementsByTagName(<span class="hljs-string">'img'</span>)[<span class="hljs-number">0</span>]
    robot.img.onload = setDefaults;
  }</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><h2 id="remember-the-initial-information-about-the-robot">Remember the initial information about the robot.</h2></div></div></div><div class="segment"><div class="code"><div class="wrapper">  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">setDefaults</span>(<span class="hljs-params"></span>)</span>{
    robot.defaults = {}
    robot.defaults.src = robot.img.src;
    robot.defaults.position = getPosition();
    robot.defaults.position.scale = <span class="hljs-number">1</span>;
    robot.defaults.position.rotate = <span class="hljs-number">0</span>;
  }

  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getPosition</span>(<span class="hljs-params"></span>)</span>{
    <span class="hljs-keyword">var</span> robotSize = getSize();
    <span class="hljs-keyword">var</span> boundingRectangle = robot.element.getBoundingClientRect();

    <span class="hljs-keyword">var</span> center = {
      x: (robotSize.width)/<span class="hljs-number">2</span> + boundingRectangle.left,
      y: (robotSize.height)/<span class="hljs-number">2</span> + boundingRectangle.top
    };

    <span class="hljs-keyword">return</span> center;
  }

  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getSize</span>(<span class="hljs-params"></span>)</span>{
    <span class="hljs-keyword">var</span> boundingRectangle = robot.element.getBoundingClientRect();
    <span class="hljs-keyword">var</span> size = {
      width: boundingRectangle.right - boundingRectangle.left,
      height: boundingRectangle.bottom - boundingRectangle.top
    };

    <span class="hljs-keyword">return</span> size;
  }

  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">moveTo</span>(<span class="hljs-params">x, y</span>)</span>{
    orient(x, y);
    positionTo(x, y);
  }

  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">positionTo</span>(<span class="hljs-params">x, y</span>) </span>{
    <span class="hljs-keyword">var</span> robotSize = getSize();
    robot.element.style.left = x - robotSize.width/<span class="hljs-number">2</span> + <span class="hljs-string">'px'</span>;
    robot.element.style.top = y - robotSize.height/<span class="hljs-number">2</span> + <span class="hljs-string">'px'</span>;
  }

  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">orient</span>(<span class="hljs-params">x, y</span>)</span>{
    <span class="hljs-keyword">var</span> angle = calculateAngle({x: x, y: y});
    <span class="hljs-keyword">var</span> scale = calculateScale({x: x, y: y});
    transform(angle, scale);
  }

  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">transform</span>(<span class="hljs-params">angle, scale</span>) </span>{
    robot.position = robot.position || {};
    <span class="hljs-keyword">var</span> transform = <span class="hljs-string">''</span>;

    <span class="hljs-keyword">if</span>(isNumber(angle)) {
      transform += <span class="hljs-string">'rotate('</span> + angle + <span class="hljs-string">'deg)'</span>;
    }
    <span class="hljs-keyword">if</span>(isNumber(scale)) {
      transform += <span class="hljs-string">' scaleX('</span> + scale + <span class="hljs-string">')'</span>;
    }
    robot.position.angle = angle;
    robot.position.scale = scale;
    robot.img.style.transform = transform;
  }

  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getDirection</span>(<span class="hljs-params">distance</span>) </span>{
    <span class="hljs-keyword">return</span> distance/<span class="hljs-built_in">Math</span>.abs(distance);
  }

  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">isNumber</span>(<span class="hljs-params">number</span>) </span>{
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">typeof</span> number == <span class="hljs-string">'number'</span> &amp;&amp; number.toString() !== <span class="hljs-string">'NaN'</span>
  }

  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">calculateAngle</span>(<span class="hljs-params">destination</span>) </span>{
    <span class="hljs-keyword">var</span> currentPosition = getPosition();
    <span class="hljs-keyword">var</span> xDist = destination.x - currentPosition.x;
    <span class="hljs-keyword">var</span> yDist = currentPosition.y - destination.y;

    <span class="hljs-keyword">if</span>(xDist == <span class="hljs-number">0</span>){
      <span class="hljs-keyword">return</span> getDirection(yDist) * <span class="hljs-number">90</span>;
    }

    <span class="hljs-keyword">return</span> <span class="hljs-built_in">Math</span>.atan(yDist/xDist) / <span class="hljs-built_in">Math</span>.PI * <span class="hljs-number">180</span>;
  }

  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">calculateScale</span>(<span class="hljs-params">destination</span>) </span>{
    <span class="hljs-keyword">var</span> currentPosition = getPosition();
    <span class="hljs-keyword">var</span> xDist = destination.x - currentPosition.x;

    <span class="hljs-keyword">return</span> getDirection(xDist);
  }


  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">move</span>(<span class="hljs-params">direction, distance</span>)</span>{

    <span class="hljs-keyword">var</span> movers = {
      left: moveLeft,
      right: moveRight,
      down: moveDown,
      up: moveUp
    };

    <span class="hljs-keyword">return</span> <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)</span>{
      movers[direction](distance);
      <span class="hljs-keyword">return</span> <span class="hljs-string">'moved '</span> + distance + <span class="hljs-string">' '</span> + direction;
    }();

    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">moveLeft</span> (<span class="hljs-params">distance</span>) </span>{
      <span class="hljs-keyword">var</span> currentPosition = getPosition();
      <span class="hljs-keyword">var</span> newX = currentPosition.x + distance;

      moveTo(newX, currentPosition.y);
    }

    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">moveDown</span> (<span class="hljs-params">distance</span>) </span>{
      <span class="hljs-keyword">var</span> currentPosition = getPosition();
      <span class="hljs-keyword">var</span> newY = currentPosition.y + distance;

      moveTo(currentPosition.x, newY);
    }

    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">moveRight</span> (<span class="hljs-params">distance</span>) </span>{
      moveLeft( - <span class="hljs-number">1</span> * distance);
    }

    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">moveUp</span> (<span class="hljs-params">distance</span>) </span>{
      moveDown( - <span class="hljs-number">1</span> * distance);
    }
  }

  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">change</span>(<span class="hljs-params">imageURL</span>) </span>{
    robot.img.src = imageURL;
  }

  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">reset</span>(<span class="hljs-params"></span>) </span>{
    moveTo(robot.defaults.position.x, robot.defaults.position.y);
    transform(robot.defaults.position.angle, robot.defaults.position.scale);
    change(robot.defaults.src);
  }

  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">name</span>(<span class="hljs-params">robotName</span>) </span>{
    robot.element.dataset.name = robotName;
  }

  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">flip</span>(<span class="hljs-params"></span>)</span>{
    robot.element.classList.toggle(<span class="hljs-string">'flip'</span>);
  }

  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getElement</span>(<span class="hljs-params"></span>)</span>{
    <span class="hljs-keyword">return</span> robot.element;
  }
}</div></div></div></div></body></html>